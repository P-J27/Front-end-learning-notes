![image-20210526205628428](https://gitee.com/p_pj/picgo/raw/master/img/20210528103720.png)

--------------

> é¢è¯•å®˜ï¼šå†™ä¸ªæ·±æµ…æ‹·è´å§ã€‚ æˆ‘ï¼š....ğŸ’¥(åŸåœ°çˆ†ç‚¸)

---------------



#### ä»€ä¹ˆæ˜¯æ·±æµ…æ‹·è´ï¼Ÿ

 å¯¹åŸºæœ¬ç±»å‹çš„æ‹·è´å°± æ˜¯å¯¹å€¼å¤åˆ¶è¿›è¡Œä¸€æ¬¡æ‹·è´ï¼Œè€Œå¯¹äºå¼•ç”¨ç±»å‹æ¥è¯´ï¼Œæ‹·è´çš„ä¸æ˜¯å€¼ï¼Œè€Œæ˜¯å€¼çš„åœ°å€ï¼Œæœ€ç»ˆä¸¤ä¸ªå˜é‡çš„åœ°å€ æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå€¼ã€‚è¿˜æ˜¯ä»¥å‰çš„ä¾‹å­ï¼š è¦æƒ³å°† obj1 å’Œ obj2 çš„å…³ç³»æ–­å¼€ï¼Œä¹Ÿå°±æ˜¯ä¸è®©ä»–æŒ‡å‘åŒä¸€ä¸ªåœ°å€ã€‚æ ¹æ®ä¸åŒå±‚æ¬¡çš„æ‹·è´ï¼Œåˆ†ä¸ºæ·±æ‹·è´ å’Œæµ…æ‹·è´ã€‚ 

- **æµ…æ‹·è´ï¼šåªè¿›è¡Œä¸€å±‚å…³ç³»çš„æ‹·è´ã€‚**
-  **æ·±æ‹·è´ï¼šè¿›è¡Œæ— é™å±‚æ¬¡çš„æ‹·è´ã€‚**



æµ…æ‹·è´ï¼šåªè€ƒè™‘å¯¹è±¡ç±»å‹ã€‚

```js
function shallowCopy(obj) {
    if (typeof obj !== 'object') return obj
    
    let newObj = obj instanceof Array ? [] : {}
    for (let key in obj) {
        if (obj.hasOwnProperty(key)) {
            newObj[key] = obj[key]
        }
    }
    return newObj
}
```



æ—¢ç„¶`æµ…æ‹·è´`è¾¾ä¸åˆ°æˆ‘ä»¬çš„è¦æ±‚ï¼Œæœ¬ç€**æ•ˆç‡**çš„åŸåˆ™ï¼Œæˆ‘ä»¬æ‰¾æ‰¾æœ‰æ²¡æœ‰å¸®åŠ©æˆ‘ä»¬å®ç°`æ·±æ‹·è´`çš„æ–¹æ³•ã€‚

![image-20210528104534627](https://gitee.com/p_pj/picgo/raw/master/img/20210528104534.png)

ç®€å•ç‰ˆæ·±æ‹·è´ï¼šåªè€ƒè™‘æ™®é€šå¯¹è±¡å±æ€§ï¼Œä¸è€ƒè™‘å†…ç½®å¯¹è±¡å’Œå‡½æ•°ã€‚

```js
function deepClone(obj) {
    if (typeof obj !== 'object') return;
    var newObj = obj instanceof Array ? [] : {};
    for (var key in obj) {
        if (obj.hasOwnProperty(key)) {
            newObj[key] = typeof obj[key] === 'object' ? deepClone(obj[key]) : obj[key];
        }
    }
    return newObj;
}
```

å¤æ‚ç‰ˆæ·±å…‹éš†ï¼šåŸºäºç®€å•ç‰ˆçš„åŸºç¡€ä¸Šï¼Œè¿˜è€ƒè™‘äº†å†…ç½®å¯¹è±¡æ¯”å¦‚ Dateã€RegExp ç­‰å¯¹è±¡å’Œå‡½æ•°ä»¥åŠè§£å†³äº†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚

```js
const isObject = (target) => (typeof target === "object" || typeof target === "function") && target !== null;

function deepClone(target, map = new WeakMap()) {
    if (map.get(target)) {
        return target;
    }
    // è·å–å½“å‰å€¼çš„æ„é€ å‡½æ•°ï¼šè·å–å®ƒçš„ç±»å‹
    let constructor = target.constructor;
    // æ£€æµ‹å½“å‰å¯¹è±¡targetæ˜¯å¦ä¸æ­£åˆ™ã€æ—¥æœŸæ ¼å¼å¯¹è±¡åŒ¹é…
    if (/^(RegExp|Date)$/i.test(constructor.name)) {
        // åˆ›å»ºä¸€ä¸ªæ–°çš„ç‰¹æ®Šå¯¹è±¡(æ­£åˆ™ç±»/æ—¥æœŸç±»)çš„å®ä¾‹
        return new constructor(target);  
    }
    if (isObject(target)) {
        map.set(target, true);  // ä¸ºå¾ªç¯å¼•ç”¨çš„å¯¹è±¡åšæ ‡è®°
        const cloneTarget = Array.isArray(target) ? [] : {};
        for (let prop in target) {
            if (target.hasOwnProperty(prop)) {
                cloneTarget[prop] = deepClone(target[prop], map);
            }
        }
        return cloneTarget;
    } else {
        return target;
    }
}
```

![image-20210528104426481](https://gitee.com/p_pj/picgo/raw/master/img/20210528104426.png)